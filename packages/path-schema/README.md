<br>

<p align="center">
  <img width="197" src="https://github.com/enio-ireland/enio/blob/develop/images/path-schema.png?raw=true">
</p>

<p align="center">
  <img alt="npm" src="https://img.shields.io/npm/v/@enio.ai/path-schema?style=flat-square">
  <img alt="NPM" src="https://img.shields.io/npm/l/@enio.ai/path-schema?style=flat-square">
  <img alt="npm" src="https://img.shields.io/npm/dm/@enio.ai/path-schema?style=flat-square">
  <img alt="GitHub contributors (via allcontributors.org)" src="https://img.shields.io/github/all-contributors/enio-ireland/enio/develop?color=%23&style=flat-square">
  <img alt="GitHub Sponsors" src="https://img.shields.io/github/sponsors/enio-ireland?style=flat-square">
</p>

<p align="center">
  <a href="https://github.com/enio-ireland/enio/tree/develop/packages/path-schema">path-schema</a> is set of utils to define your firebase database schema. It is created, maintained, and released as open source under MIT license by a group of passionate individuals in <a href="https://github.com/enio-ireland/enio">Enio</a>.
</p>

<br>
<br>

## News

- [2023-02-11](https://github.com/enio-ireland/enio/blob/develop/packages/path-schema/CHANGELOG.md#200-2023-02-11) - First release (beta) :tada:.

## Key Features

1. **Model** your no-sql **database schema with ease** using a simple, human-readable syntax. This will help you move away from maintaining cluttered code with constant variables and enums to manage your database paths.
2. **Built-in syntax validation** ensures your database schema is always in check.
3. Get **autogenerated TypeScript interfaces** for your database references to enjoy intellisense.
4. Read paths and **hydrate dynamic values** with `.pathWithKeys()`.

This library was designed with Firebase database use cases in mind.

We've got even more in store for you - support for database schemas with circular references and a CLI version of `getDefinitions()` and config file are in the works.

<br>

## Status: Beta :alembic:

This project is in "beta" release, which means; it's all new and needs feedback from the community to improve it further. It's all new and mostly solves our use case to map firebase database paths neatly.

If you find this project useful and want to see more projects like this, consider signing up for support. You can find details are [at the very end. :point_down: :seedling:](#sponsors)

<br>

## Installation

Using npm:

```
$ npm i -g npm
$ npm i --save @enio.ai/path-schema
```

<br>

## How to Use

You can import utils from [path-schema]() just as you would with other npm packages.

```javascript
import { getPaths } from '@enio.ai/path-schema'
```

<br>

### Overview

- [:pushpin: News](#news)
- [:trophy: Key Features](#key-features)
- [:heavy_check_mark: Status](#status-beta-alembic)
- [:open_book: Installation](#installation)
- [:open_book: How to Use](#how-to-use)
- **[:compass: Overview](#overview)**
- [:sparkles: API](#api)
  - [:bookmark_tabs: Database Schema](#database-schema)
  - [:key: Database Reference](#database-reference)
  - [:globe_with_meridians: TypeScript Interface](#typescript-interface)
  - [:zap: Help with Advanced Database Schemas](#help-with-advanced-database-schemas)
- [:technologist: Contributors](#contributors-link)
- [:people_hugging: Sponsors](#sponsors)

<br>

## API

### Database Schema

To get started, you need to write your database schema as a string. Each line in the string represents a node in your schema, and the relationships between nodes are defined using the Â» symbol. For example:

```
@root Â» #opensource #enterprise
#opensource Â» #projects
#enterprise Â» #projects
#projects Â» #badges
#badges Â» #coverageBadge #buildBadge
#coverageBadge
#buildBadge
```

> In this example, the **@root** node is the root of the database, and it has two children, _#opensource_ and _#enterprise_. The _#projects_ node is a child of both the _#opensource_ and _#enterprise_ nodes, and the _#badges_ node is a child of the _#projects_ node. The _#coverageBadge_ and _#buildBadge_ nodes are children of the _#badges_ node.

### Database Reference

The database reference is an object created at runtime that contains the path details of every node of your database represented by the schema, which can be accessed through dot notation.

To generate a database reference, use the [getPaths()]() function and pass in your schema string as an argument.

```typescript
import { getPaths } from '@enio.ai/path-schema';

const dbRefs = getPaths(yourSchemaString);
```

Using the previous example, you can simply pass a template string directly.

```typescript
import { getPaths } from '@enio.ai/path-schema';

const dbRefs = getPaths(`
  @root Â» #opensource #enterprise
  #opensource Â» #projects
  #enterprise Â» #projects
  #projects Â» #badges
  #badges Â» #coverageBadge #buildBadge
  #coverageBadge
  #buildBadge
`);
```

### TypeScript Interface

Because the database reference is instanced at runtime, to get the benefit of IntelliSense to access properties in dot notation when you are using TypeScript, the [getPaths()]() accepts an interface or type.

Here is an example;

```typescript
import type { Reference } from '@enio.ai/path-schema';
import { getPaths } from '@enio.ai/path-schema';

type RootPaths = 'opensource' | 'enterprise'
type ProjectCategoryPaths = 'projects'
type ProjectPaths = 'badges'
type BadgePaths = 'coverageBadge' | 'buildBadge'

type Badges = Reference & {
  [key in BadgePaths]: Reference
}

type Project = Reference & {
  [key in ProjectPaths]: Badges
}

type ProjectCategories = Reference & {
  [key in ProjectCategoryPaths]: Project
}

type DB = Reference & {
  [key in RootPaths]: ProjectCategories
}

const dbRefs = getPaths<DB>(`
  @root Â» #opensource #enterprise
  #opensource Â» #projects
  #enterprise Â» #projects
  #projects Â» #badges
  #badges Â» #coverageBadge #buildBadge
  #coverageBadge
  #buildBadge
`);
```

<p align="center">
  <img src="https://github.com/enio-ireland/enio/blob/develop/images/path-schema-demo-1.gif?raw=true">
</p>

### Help with Advanced Database Schemas

Database schemas vary in complexity, and creating an interface could become less straightforward. You can use [getDefinition()]().

[getDefinition()]() takes in your schema string as an argument. The function will return a string that represents the TypeScript definitions for your database schema.

```typescript
import { getDefinition } from '@enio.ai/path-schema';

console.log(getDefinition(`
  @root Â» #opensource #enterprise
  #opensource Â» #projects
  #enterprise Â» #projects
  #projects Â» #badges
  #badges Â» #coverageBadge #buildBadge
  #coverageBadge
  #buildBadge
`));
```

<br>

And that's it! You should now have a good understanding of how to model your own database schema using the getDefinition and getPaths functions. If you have any questions or need further clarification, feel free to ask.

<br>

## [Contributors :link:](https://github.com/enio-ireland/enio/blob/develop/CONTRIBUTORS.md)

<br>

## Sponsors

<p style="text-align: justify">
  Maintenance of this project is made possible by all the contributors and sponsors. If you'd like to sponsor this project and have your avatar or company logo appear below <a href="https://github.com/sponsors/enio-ireland">click here</a>. ðŸ’–
</p>

(This list will be automatically generated in the future.)
